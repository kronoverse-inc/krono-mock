!function(e){function t(t){for(var i,a,r=t[0],l=t[1],c=t[2],g=0,d=[];g<r.length;g++)a=r[g],Object.prototype.hasOwnProperty.call(o,a)&&o[a]&&d.push(o[a][0]),o[a]=0;for(i in l)Object.prototype.hasOwnProperty.call(l,i)&&(e[i]=l[i]);for(h&&h(t);d.length;)d.shift()();return s.push.apply(s,c||[]),n()}function n(){for(var e,t=0;t<s.length;t++){for(var n=s[t],i=!0,r=1;r<n.length;r++){var l=n[r];0!==o[l]&&(i=!1)}i&&(s.splice(t--,1),e=a(a.s=n[0]))}return e}var i={},o={0:0},s=[];function a(t){if(i[t])return i[t].exports;var n=i[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,a),n.l=!0,n.exports}a.m=e,a.c=i,a.d=function(e,t,n){a.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},a.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},a.t=function(e,t){if(1&t&&(e=a(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(a.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)a.d(n,i,function(t){return e[t]}.bind(null,i));return n},a.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return a.d(t,"a",t),t},a.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},a.p="wallet";var r=window.webpackJsonp=window.webpackJsonp||[],l=r.push.bind(r);r.push=t,r=r.slice();for(var c=0;c<r.length;c++)t(r[c]);var h=l;s.push([63,1,4,2,3,5]),n()}({101:function(e,t){},103:function(e,t){},29:function(e,t){e.exports=fetch},57:function(e,t){e.exports=Run},63:function(e,t,n){e.exports=n(64)},64:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(65);function o(){Array.from(document.getElementsByClassName("panel")).forEach(e=>e.style.display="none")}document.addEventListener("DOMContentLoaded",async e=>{var t,n;console.log("LOADED");const s=new i.WalletService;s.on("show",e=>{console.log("SHOW:",e),function(e){o();const t=document.getElementById(e);t&&(t.style.display="block")}(e)}),s.on("hide",e=>{o()});try{await s.init()}catch(e){console.log(e)}null===(t=document.getElementById("login-btn"))||void 0===t||t.addEventListener("click",e=>{var t,n;const i=null===(t=document.getElementById("l-handle"))||void 0===t?void 0:t.value,o=null===(n=document.getElementById("l-password"))||void 0===n?void 0:n.value;s.login(i,o)}),null===(n=document.getElementById("register-btn"))||void 0===n||n.addEventListener("click",e=>{var t,n,i;const o=null===(t=document.getElementById("r-handle"))||void 0===t?void 0:t.value,a=null===(n=document.getElementById("r-email"))||void 0===n?void 0:n.value,r=null===(i=document.getElementById("r-password"))||void 0===i?void 0:i.value;s.register(o,r,a)});const a=document.createElement("h1");document.body.appendChild(a)})},65:function(e,t,n){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0}),t.WalletService=void 0;const i=n(16),o=n(115),s=n(116),a=n(119),r=n(120),l=n(127),c=n(128),h=n(21),g=n(129),d=n(7),u=n(133),f=n(57);let p={};const m=window.location.href.split("?");if(m[1]){const[e]=m[1].split("#");p=s.decode(e)}i.Constants.Default="main"===o.config.network?i.Constants.Mainnet:i.Constants.Testnet;const y=n(16);y.Constants.Default=i.Constants.Default,console.log("LOAD");class w extends d.EventEmitter{constructor(){super(),this.printLog=console.log.bind(console),this.printError=console.error.bind(console),this.logId=0,this.logs=[],this.sessionId=`${Date.now()}-${Math.random()*Number.MAX_SAFE_INTEGER}`,this.timeLabels={},this.apiUrl=p.apiUrl||o.config.apiUrl,this.domain=document.location.hash.slice(1).split("@")[1],this.overrideConsole(),this.auth=new g.KronoAuth(this.apiUrl,this.domain,o.config.network)}get channel(){const e=window.vuplex;return e||window}get channelScope(){const e=document.referrer;return e&&!this.isInUnity?e.match(/^.+:\/\/[^\/]+/)[0]:null}get isInUnity(){return!!window.vuplex}get handle(){return window.localStorage.getItem("HANDLE")||""}set handle(e){window.localStorage.setItem("HANDLE",e)}get keyPair(){const e=window.localStorage.getItem("WIF");return e?i.KeyPair.fromPrivKey(i.PrivKey.fromString(e)):null}set keyPair(e){window.localStorage.setItem("WIF",e.privKey.toString())}get agentId(){return document.location.hash.slice(1).split("@")[0]}get paymail(){return`${this.handle}@${this.domain}`}async init(){console.log("INIT");let e=!1;for(;o.config.ephemeral&&!e;){await new Promise(e=>setTimeout(()=>e(),5e3));const t=await fetch(this.apiUrl+"/initialize");e=t.ok&&await t.json()}this.clientEmit("WALLET_READY"),this.channel.addEventListener("message",this.onClientEvent.bind(this)),console.log("BLOCKCHAIN:",this.apiUrl);const t=`${this.apiUrl}/agents/${this.domain}/${this.agentId}`;console.log("fetching:",t);const n=await fetch(t);if(!n.ok)throw new Error(`${n.status} - ${n.statusText}`);if(this.agentDef=await n.json(),!this.agentDef)throw new Error("AGENT MISSING");if(o.config.errorLog&&setInterval(async()=>{const e=this.logs;if(this.logs=[],!e.length)return;const t=await fetch(o.config.errorLog,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(!t.ok)throw new Error(`${t.status} - ${t.statusText}`)},5e3),this.agentDef.anonymous)return this.initializeWallet();if(!o.config.ephemeral&&!this.keyPair)return this.clientEmit("NO_KEYS");try{await this.initializeUser()}catch(e){console.error("Login Error:",e.message),this.clientEmit("NO_KEYS")}}async initializeWallet(t,n){const i=new f.LocalCache({maxSizeMB:100}),s=new r.RestBlockchain(this.apiUrl,o.config.network,i),g=new f({network:o.config.network,owner:t,blockchain:s,purse:n,cache:new l.RestStateCache(this.apiUrl,i),app:o.config.app||"kronoverse",trust:"*",timeout:6e4,logger:{error:console.error}}),d=this.wallet=new a.Wallet(this.paymail,this.keyPair,g),p=new c.IORedisMock,m=[this.keyPair.pubKey.toString()];let w;o.config.sockets&&(console.log("Sockets:",o.config.sockets),w=new u.WSClient(WebSocket,o.config.sockets,m)),console.log("DOMAIN:",this.domain),console.log("AGENT_ID:",this.agentId),console.log("LOC:",this.agentDef.location);const v=await g.load(this.agentDef.location),E=this.agent=new v(d,s,p,y,{fetch:fetch,Buffer:e,ws:w,SignedMessage:h.SignedMessage});E.on("client",this.clientEmit.bind(this)),E.on("subscribe",(e,t)=>{w.subscribe(e,t)}),E.on("unsubscribe",e=>{w.unsubscribe(e)}),await E.init(),this.clientEmit("AGENT_LOADED"),w.on("jig",(e,t)=>{console.log("JIG:",JSON.stringify(e)),E.onJig(e).catch(console.error)}),w.on("msg",(e,t)=>{console.log("MSG:",JSON.stringify(e)),E.onMessage(new h.SignedMessage(e)).catch(console.error)})}async initializeUser(e){let t;if(console.log("Initializing User"),e&&(this.handle=e),o.config.ephemeral)t=i.Bip32.fromRandom(),this.keyPair=i.KeyPair.fromPrivKey(t.privKey);else{console.log("Recovering account");const e=await this.auth.recover(this.paymail,this.keyPair);t=i.Bip32.fromString(e)}this.initializeWallet(t.derive("m/1/0").privKey.toString(),t.derive("m/0/0").privKey.toString())}async login(e,t){this.keyPair=await this.auth.login(e,t),await this.initializeUser(e)}async register(e,t,n){this.keyPair=await this.auth.register(e,t,n),await this.initializeUser(e)}async logout(){window.localStorage.removeItem("WIF"),window.localStorage.removeItem("HANDLE")}async onClientEvent(e){var t;const n={};if(!this.tryParseMessageData(e.data,n))return;["Register","Login"].includes(n.name)?console.log("WALLET RECEIVED EVENT:",n.name):console.log("WALLET RECEIVED EVENT:",JSON.stringify(n));const i={name:"On"+n.name};try{const e=n.payload&&JSON.parse(n.payload);switch(n.name){case"Register":await this.register(e.handle,e.password,e.email);break;case"Login":await this.login(e.handle,e.password);break;case"Logout":await this.logout();break;case"Cashout":if(!this.wallet)throw new Error("Wallet not initialized");this.clientEmit("BalanceUpdated",0);break;case"IsHandleAvailable":i.payload=JSON.stringify(await this.auth.isHandleAvailable(e));break;default:if(!this.agent)throw new Error("Agent not initialized");const o=await(null===(t=this.agent)||void 0===t?void 0:t.onEvent(n.name,e));i.payload=o&&JSON.stringify(o)}i.success=!0}catch(e){i.success=!1,i.payload=JSON.stringify(e.message),e.message.includes("Not enough funds")?i.statusCode=402:i.statusCode=e.status||500}console.log(i.name,i.payload),this.postMessage(i)}tryParseMessageData(t,n){const i=n||{};return"string"==typeof t?Object.assign(i,JSON.parse(e.from(t,"base64").toString())):"object"==typeof t&&Object.assign(i,t),i&&i.name}clientEmit(e,t){const n={name:e,payload:t&&JSON.stringify(t),success:!0};this.logs.push({idx:this.logId++,sessionId:this.sessionId,handle:this.handle,type:"log",ts:Date.now(),message:{name:e,payload:t}}),this.postMessage(n)}postMessage(e){e.target="kronoverse",this.isInUnity?this.channel.postMessage(e):this.channelScope&&this.channel.parent.postMessage(e,this.channelScope)}overrideConsole(){console.log=(...e)=>{e.unshift(Date.now());const t=e.join(" ");this.logs.push({idx:this.logId++,sessionId:this.sessionId,paymail:this.paymail,type:"log",ts:Date.now(),message:t}),o.config.emitLogs&&this.clientEmit("Log",t),this.printLog(...e)},console.error=(...e)=>{e.unshift(Date.now());const t=e.join(" ");this.logs.push({idx:this.logId++,sessionId:this.sessionId,paymail:this.paymail,type:"error",ts:Date.now(),message:t}),o.config.emitLogs&&this.clientEmit("Error",t),this.printError(...e)},console.time=e=>{this.timeLabels[e]=Date.now()},console.timeEnd=e=>{console.log(`${e}: ${Date.now()-this.timeLabels[e]||0}ms`)}}}t.WalletService=w}).call(this,n(3).Buffer)},68:function(e,t){},71:function(e,t){},72:function(e,t){},88:function(e,t){},90:function(e,t){}});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vd2VicGFjay9ib290c3RyYXAiLCJ3ZWJwYWNrOi8vL2V4dGVybmFsIFwiZmV0Y2hcIiIsIndlYnBhY2s6Ly8vZXh0ZXJuYWwgXCJSdW5cIiIsIndlYnBhY2s6Ly8vLi9zcmMvaW5kZXgudHMiLCJ3ZWJwYWNrOi8vLy4vc3JjL3NlcnZpY2VzL3dhbGxldC1zZXJ2aWNlLnRzIl0sIm5hbWVzIjpbIndlYnBhY2tKc29ucENhbGxiYWNrIiwiZGF0YSIsIm1vZHVsZUlkIiwiY2h1bmtJZCIsImNodW5rSWRzIiwibW9yZU1vZHVsZXMiLCJleGVjdXRlTW9kdWxlcyIsImkiLCJyZXNvbHZlcyIsImxlbmd0aCIsIk9iamVjdCIsInByb3RvdHlwZSIsImhhc093blByb3BlcnR5IiwiY2FsbCIsImluc3RhbGxlZENodW5rcyIsInB1c2giLCJtb2R1bGVzIiwicGFyZW50SnNvbnBGdW5jdGlvbiIsInNoaWZ0IiwiZGVmZXJyZWRNb2R1bGVzIiwiYXBwbHkiLCJjaGVja0RlZmVycmVkTW9kdWxlcyIsInJlc3VsdCIsImRlZmVycmVkTW9kdWxlIiwiZnVsZmlsbGVkIiwiaiIsImRlcElkIiwic3BsaWNlIiwiX193ZWJwYWNrX3JlcXVpcmVfXyIsInMiLCJpbnN0YWxsZWRNb2R1bGVzIiwiMCIsImV4cG9ydHMiLCJtb2R1bGUiLCJsIiwibSIsImMiLCJkIiwibmFtZSIsImdldHRlciIsIm8iLCJkZWZpbmVQcm9wZXJ0eSIsImVudW1lcmFibGUiLCJnZXQiLCJyIiwiU3ltYm9sIiwidG9TdHJpbmdUYWciLCJ2YWx1ZSIsInQiLCJtb2RlIiwiX19lc01vZHVsZSIsIm5zIiwiY3JlYXRlIiwia2V5IiwiYmluZCIsIm4iLCJvYmplY3QiLCJwcm9wZXJ0eSIsInAiLCJqc29ucEFycmF5Iiwid2luZG93Iiwib2xkSnNvbnBGdW5jdGlvbiIsInNsaWNlIiwiZmV0Y2giLCJSdW4iLCJ3YWxsZXRfc2VydmljZV8xIiwiaGlkZSIsIkFycmF5IiwiZnJvbSIsImRvY3VtZW50IiwiZ2V0RWxlbWVudHNCeUNsYXNzTmFtZSIsImZvckVhY2giLCJzdHlsZSIsImRpc3BsYXkiLCJhZGRFdmVudExpc3RlbmVyIiwiYXN5bmMiLCJldmVudCIsIl9hIiwiX2IiLCJjb25zb2xlIiwibG9nIiwid2FsbGV0IiwiV2FsbGV0U2VydmljZSIsIm9uIiwicGFuZWwiLCJwYW5lbEVsZW1lbnQiLCJnZXRFbGVtZW50QnlJZCIsInNob3ciLCJpbml0IiwiZXJyIiwiZSIsImhhbmRsZSIsInBhc3N3b3JkIiwibG9naW4iLCJfYyIsImVtYWlsIiwicmVnaXN0ZXIiLCJlbGVtZW50IiwiY3JlYXRlRWxlbWVudCIsImJvZHkiLCJhcHBlbmRDaGlsZCIsImJzdl8xIiwibm9kZV9jb25maWdfdHNfMSIsInF1ZXJ5c3RyaW5nIiwid2FsbGV0XzEiLCJyZXN0X2Jsb2NrY2hhaW5fMSIsInJlc3Rfc3RhdGVfY2FjaGVfMSIsImlvcmVkaXNfbW9ja18xIiwic2lnbmVkX21lc3NhZ2VfMSIsImF1dGhfMSIsImV2ZW50c18xIiwid3NfY2xpZW50XzEiLCJxdWVyeVBhcmFtcyIsInVybFBhcnRzIiwibG9jYXRpb24iLCJocmVmIiwic3BsaXQiLCJxdWVyeSIsImRlY29kZSIsIkNvbnN0YW50cyIsIkRlZmF1bHQiLCJjb25maWciLCJuZXR3b3JrIiwiTWFpbm5ldCIsIlRlc3RuZXQiLCJic3YiLCJFdmVudEVtaXR0ZXIiLCJzdXBlciIsInRoaXMiLCJwcmludExvZyIsInByaW50RXJyb3IiLCJlcnJvciIsImxvZ0lkIiwibG9ncyIsInNlc3Npb25JZCIsIkRhdGUiLCJub3ciLCJNYXRoIiwicmFuZG9tIiwiTnVtYmVyIiwiTUFYX1NBRkVfSU5URUdFUiIsInRpbWVMYWJlbHMiLCJhcGlVcmwiLCJkb21haW4iLCJoYXNoIiwib3ZlcnJpZGVDb25zb2xlIiwiYXV0aCIsIktyb25vQXV0aCIsInYiLCJ2dXBsZXgiLCJyZWYiLCJyZWZlcnJlciIsImlzSW5Vbml0eSIsIm1hdGNoIiwibG9jYWxTdG9yYWdlIiwiZ2V0SXRlbSIsInNldEl0ZW0iLCJ3aWYiLCJLZXlQYWlyIiwiZnJvbVByaXZLZXkiLCJQcml2S2V5IiwiZnJvbVN0cmluZyIsImtleVBhaXIiLCJwcml2S2V5IiwidG9TdHJpbmciLCJpbml0aWFsaXplZCIsImVwaGVtZXJhbCIsIlByb21pc2UiLCJyZXNvbHZlIiwic2V0VGltZW91dCIsInJlc3AiLCJvayIsImpzb24iLCJjbGllbnRFbWl0IiwiY2hhbm5lbCIsIm9uQ2xpZW50RXZlbnQiLCJ1cmwiLCJhZ2VudElkIiwiRXJyb3IiLCJzdGF0dXMiLCJzdGF0dXNUZXh0IiwiYWdlbnREZWYiLCJlcnJvckxvZyIsInNldEludGVydmFsIiwibWV0aG9kIiwiaGVhZGVycyIsIkpTT04iLCJzdHJpbmdpZnkiLCJhbm9ueW1vdXMiLCJpbml0aWFsaXplV2FsbGV0IiwiaW5pdGlhbGl6ZVVzZXIiLCJtZXNzYWdlIiwib3duZXIiLCJwdXJzZSIsImNhY2hlIiwiTG9jYWxDYWNoZSIsIm1heFNpemVNQiIsImJsb2NrY2hhaW4iLCJSZXN0QmxvY2tjaGFpbiIsInJ1biIsIlJlc3RTdGF0ZUNhY2hlIiwiYXBwIiwidHJ1c3QiLCJ0aW1lb3V0IiwibG9nZ2VyIiwiV2FsbGV0IiwicGF5bWFpbCIsInN0b3JhZ2UiLCJJT1JlZGlzTW9jayIsImNoYW5uZWxzIiwicHViS2V5Iiwid3MiLCJzb2NrZXRzIiwiV1NDbGllbnQiLCJXZWJTb2NrZXQiLCJBZ2VudCIsImxvYWQiLCJhZ2VudCIsIkJ1ZmZlciIsIlNpZ25lZE1lc3NhZ2UiLCJsYXN0SWQiLCJzdWJzY3JpYmUiLCJ1bnN1YnNjcmliZSIsImppZyIsIm9uSmlnIiwiY2F0Y2giLCJvbk1lc3NhZ2UiLCJiaXAzMiIsIkJpcDMyIiwiZnJvbVJhbmRvbSIsInhwcml2IiwicmVjb3ZlciIsImRlcml2ZSIsInJlbW92ZUl0ZW0iLCJ0cnlQYXJzZU1lc3NhZ2VEYXRhIiwiaW5jbHVkZXMiLCJyZXNwb25zZSIsInBheWxvYWQiLCJwYXJzZSIsImxvZ291dCIsImlzSGFuZGxlQXZhaWxhYmxlIiwib25FdmVudCIsInN1Y2Nlc3MiLCJzdGF0dXNDb2RlIiwicG9zdE1lc3NhZ2UiLCJvdXRCeVJlZiIsImFzc2lnbiIsImlkeCIsInR5cGUiLCJ0cyIsInRhcmdldCIsImNoYW5uZWxTY29wZSIsInBhcmVudCIsIm1lc3NhZ2VzIiwidW5zaGlmdCIsImpvaW4iLCJlbWl0TG9ncyIsInRpbWUiLCJsYWJlbCIsInRpbWVFbmQiXSwibWFwcGluZ3MiOiJhQUNFLFNBQVNBLEVBQXFCQyxHQVE3QixJQVBBLElBTUlDLEVBQVVDLEVBTlZDLEVBQVdILEVBQUssR0FDaEJJLEVBQWNKLEVBQUssR0FDbkJLLEVBQWlCTCxFQUFLLEdBSUhNLEVBQUksRUFBR0MsRUFBVyxHQUNwQ0QsRUFBSUgsRUFBU0ssT0FBUUYsSUFDekJKLEVBQVVDLEVBQVNHLEdBQ2hCRyxPQUFPQyxVQUFVQyxlQUFlQyxLQUFLQyxFQUFpQlgsSUFBWVcsRUFBZ0JYLElBQ3BGSyxFQUFTTyxLQUFLRCxFQUFnQlgsR0FBUyxJQUV4Q1csRUFBZ0JYLEdBQVcsRUFFNUIsSUFBSUQsS0FBWUcsRUFDWkssT0FBT0MsVUFBVUMsZUFBZUMsS0FBS1IsRUFBYUgsS0FDcERjLEVBQVFkLEdBQVlHLEVBQVlILElBS2xDLElBRkdlLEdBQXFCQSxFQUFvQmhCLEdBRXRDTyxFQUFTQyxRQUNkRCxFQUFTVSxPQUFUVixHQU9ELE9BSEFXLEVBQWdCSixLQUFLSyxNQUFNRCxFQUFpQmIsR0FBa0IsSUFHdkRlLElBRVIsU0FBU0EsSUFFUixJQURBLElBQUlDLEVBQ0lmLEVBQUksRUFBR0EsRUFBSVksRUFBZ0JWLE9BQVFGLElBQUssQ0FHL0MsSUFGQSxJQUFJZ0IsRUFBaUJKLEVBQWdCWixHQUNqQ2lCLEdBQVksRUFDUkMsRUFBSSxFQUFHQSxFQUFJRixFQUFlZCxPQUFRZ0IsSUFBSyxDQUM5QyxJQUFJQyxFQUFRSCxFQUFlRSxHQUNHLElBQTNCWCxFQUFnQlksS0FBY0YsR0FBWSxHQUUzQ0EsSUFDRkwsRUFBZ0JRLE9BQU9wQixJQUFLLEdBQzVCZSxF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VkUsVUFBV04sS0FBS00sVUFDaEJ3RSxRQUFTOUUsS0FBSzhFLFFBQ2QwQyxLQUFNLE1BQ05DLEdBQUlsSCxLQUFLQyxNQUNUdUQsWUFFQXpGLEVBQWlCbUIsT0FBT3VJLFVBQ3hCaEksS0FBSzZDLFdBQVcsTUFBT2tCLEdBQzNCL0QsS0FBS0MsWUFBWTRILElBRXJCOUssUUFBUW9ELE1BQVEsSUFBSTBILEtBQ2hCQSxFQUFTQyxRQUFRdkgsS0FBS0MsT0FDdEIsTUFBTXVELEVBQVU4RCxFQUFTRSxLQUFLLEtBQzlCL0gsS0FBS0ssS0FBS3RILEtBQUssQ0FDWHdPLElBQUt2SCxLQUFLSSxRQUNWRSxVQUFXTixLQUFLTSxVQUNoQndFLFFBQVM5RSxLQUFLOEUsUUFDZDBDLEtBQU0sUUFDTkMsR0FBSWxILEtBQUtDLE1BQ1R1RCxZQUVBekYsRUFBaUJtQixPQUFPdUksVUFDeEJoSSxLQUFLNkMsV0FBVyxRQUFTa0IsR0FDN0IvRCxLQUFLRSxjQUFjMkgsSUFFdkI5SyxRQUFRa0wsS0FBUUMsSUFDWmxJLEtBQUthLFdBQVdxSCxHQUFTM0gsS0FBS0MsT0FFbEN6RCxRQUFRb0wsUUFBV0QsSUFDZm5MLFFBQVFDLElBQUksR0FBR2tMLE1BQVUzSCxLQUFLQyxNQUFRUixLQUFLYSxXQUFXcUgsSUFBVSxTQUk1RWxPLEVBQVFrRCxjQUFnQkEsSSIsImZpbGUiOiJhcHB+ZTJlOTM1OTIuanMiLCJzb3VyY2VzQ29udGVudCI6WyIgXHQvLyBpbnN0YWxsIGEgSlNPTlAgY2FsbGJhY2sgZm9yIGNodW5rIGxvYWRpbmdcbiBcdGZ1bmN0aW9uIHdlYnBhY2tKc29ucENhbGxiYWNrKGRhdGEpIHtcbiBcdFx0dmFyIGNodW5rSWRzID0gZGF0YVswXTtcbiBcdFx0dmFyIG1vcmVNb2R1bGVzID0gZGF0YVsxXTtcbiBcdFx0dmFyIGV4ZWN1dGVNb2R1bGVzID0gZGF0YVsyXTtcblxuIFx0XHQvLyBhZGQgXCJtb3JlTW9kdWxlc1wiIHRvIHRoZSBtb2R1bGVzIG9iamVjdCxcbiBcdFx0Ly8gdGhlbiBmbGFnIGFsbCBcImNodW5rSWRzXCIgYXMgbG9hZGVkIGFuZCBmaXJlIGNhbGxiYWNrXG4gXHRcdHZhciBtb2R1bGVJZCwgY2h1bmtJZCwgaSA9IDAsIHJlc29sdmVzID0gW107XG4gXHRcdGZvcig7aSA8IGNodW5rSWRzLmxlbmd0aDsgaSsrKSB7XG4gXHRcdFx0Y2h1bmtJZCA9IGNodW5rSWRzW2ldO1xuIFx0XHRcdGlmKE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChpbnN0YWxsZWRDaHVua3MsIGNodW5rSWQpICYmIGluc3RhbGxlZENodW5rc1tjaHVua0lkXSkge1xuIFx0XHRcdFx0cmVzb2x2ZXMucHVzaChpbnN0YWxsZWRDaHVua3NbY2h1bmtJZF1bMF0pO1xuIFx0XHRcdH1cbiBcdFx0XHRpbnN0YWxsZWRDaHVua3NbY2h1bmtJZF0gPSAwO1xuIFx0XHR9XG4gXHRcdGZvcihtb2R1bGVJZCBpbiBtb3JlTW9kdWxlcykge1xuIFx0XHRcdGlmKE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChtb3JlTW9kdWxlcywgbW9kdWxlSWQpKSB7XG4gXHRcdFx0XHRtb2R1bGVzW21vZHVsZUlkXSA9IG1vcmVNb2R1bGVzW21vZHVsZUlkXTtcbiBcdFx0XHR9XG4gXHRcdH1cbiBcdFx0aWYocGFyZW50SnNvbnBGdW5jdGlvbikgcGFyZW50SnNvbnBGdW5jdGlvbihkYXRhKTtcblxuIFx0XHR3aGlsZShyZXNvbHZlcy5sZW5ndGgpIHtcbiBcdFx0XHRyZXNvbHZlcy5zaGlmdCgpKCk7XG4gXHRcdH1cblxuIFx0XHQvLyBhZGQgZW50cnkgbW9kdWxlcyBmcm9tIGxvYWRlZCBjaHVuayB0byBkZWZlcnJlZCBsaXN0XG4gXHRcdGRlZmVycmVkTW9kdWxlcy5wdXNoLmFwcGx5KGRlZmVycmVkTW9kdWxlcywgZXhlY3V0ZU1vZHVsZXMgfHwgW10pO1xuXG4gXHRcdC8vIHJ1biBkZWZlcnJlZCBtb2R1bGVzIHdoZW4gYWxsIGNodW5rcyByZWFkeVxuIFx0XHRyZXR1cm4gY2hlY2tEZWZlcnJlZE1vZHVsZXMoKTtcbiBcdH07XG4gXHRmdW5jdGlvbiBjaGVja0RlZmVycmVkTW9kdWxlcygpIHtcbiBcdFx0dmFyIHJlc3VsdDtcbiBcdFx0Zm9yKHZhciBpID0gMDsgaSA8IGRlZmVycmVkTW9kdWxlcy5sZW5ndGg7IGkrKykge1xuIFx0XHRcdHZhciBkZWZlcnJlZE1vZHVsZSA9IGRlZmVycmVkTW9kdWxlc1tpXTtcbiBcdFx0XHR2YXIgZnVsZmlsbGVkID0gdHJ1ZTtcbiBcdFx0XHRmb3IodmFyIGogPSAxOyBqIDwgZGVmZXJyZWRNb2R1bGUubGVuZ3RoOyBqKyspIHtcbiBcdFx0XHRcdHZhciBkZXBJZCA9IGRlZmVycmVkTW9kdWxlW2pdO1xuIFx0XHRcdFx0aWYoaW5zdGFsbGVkQ2h1bmtzW2RlcElkXSAhPT0gMCkgZnVsZmlsbGVkID0gZmFsc2U7XG4gXHRcdFx0fVxuIFx0XHRcdGlmKGZ1bGZpbGxlZCkge1xuIFx0XHRcdFx0ZGVmZXJyZWRNb2R1bGVzLnNwbGljZShpLS0sIDEpO1xuIFx0XHRcdFx0cmVzdWx0ID0gX193ZWJwYWNrX3JlcXVpcmVfXyhfX3dlYnBhY2tfcmVxdWlyZV9fLnMgPSBkZWZlcnJlZE1vZHVsZVswXSk7XG4gXHRcdFx0fVxuIFx0XHR9XG5cbiBcdFx0cmV0dXJuIHJlc3VsdDtcbiBcdH1cblxuIFx0Ly8gVGhlIG1vZHVsZSBjYWNoZVxuIFx0dmFyIGluc3RhbGxlZE1vZHVsZXMgPSB7fTtcblxuIFx0Ly8gb2JqZWN0IHRvIHN0b3JlIGxvYWRlZCBhbmQgbG9hZGluZyBjaHVua3NcbiBcdC8vIHVuZGVmaW5lZCA9IGNodW5rIG5vdCBsb2FkZWQsIG51bGwgPSBjaHVuayBwcmVsb2FkZWQvcHJlZmV0Y2hlZFxuIFx0Ly8gUHJvbWlzZSA9IGNodW5rIGxvYWRpbmcsIDAgPSBjaHVuayBsb2FkZWRcbiBcdHZhciBpbnN0YWxsZWRDaHVua3MgPSB7XG4gXHRcdDA6IDBcbiBcdH07XG5cbiBcdHZhciBkZWZlcnJlZE1vZHVsZXMgPSBbXTtcblxuIFx0Ly8gVGhlIHJlcXVpcmUgZnVuY3Rpb25cbiBcdGZ1bmN0aW9uIF9fd2VicGFja19yZXF1aXJlX18obW9kdWxlSWQpIHtcblxuIFx0XHQvLyBDaGVjayBpZiBtb2R1bGUgaXMgaW4gY2FjaGVcbiBcdFx0aWYoaW5zdGFsbGVkTW9kdWxlc1ttb2R1bGVJZF0pIHtcbiBcdFx0XHRyZXR1cm4gaW5zdGFsbGVkTW9kdWxlc1ttb2R1bGVJZF0uZXhwb3J0cztcbiBcdFx0fVxuIFx0XHQvLyBDcmVhdGUgYSBuZXcgbW9kdWxlIChhbmQgcHV0IGl0IGludG8gdGhlIGNhY2hlKVxuIFx0XHR2YXIgbW9kdWxlID0gaW5zdGFsbGVkTW9kdWxlc1ttb2R1bGVJZF0gPSB7XG4gXHRcdFx0aTogbW9kdWxlSWQsXG4gXHRcdFx0bDogZmFsc2UsXG4gXHRcdFx0ZXhwb3J0czoge31cbiBcdFx0fTtcblxuIFx0XHQvLyBFeGVjdXRlIHRoZSBtb2R1bGUgZnVuY3Rpb25cbiBcdFx0bW9kdWxlc1ttb2R1bGVJZF0uY2FsbChtb2R1bGUuZXhwb3J0cywgbW9kdWxlLCBtb2R1bGUuZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXyk7XG5cbiBcdFx0Ly8gRmxhZyB0aGUgbW9kdWxlIGFzIGxvYWRlZFxuIFx0XHRtb2R1bGUubCA9IHRydWU7XG5cbiBcdFx0Ly8gUmV0dXJuIHRoZSBleHBvcnRzIG9mIHRoZSBtb2R1bGVcbiBcdFx0cmV0dXJuIG1vZHVsZS5leHBvcnRzO1xuIFx0fVxuXG5cbiBcdC8vIGV4cG9zZSB0aGUgbW9kdWxlcyBvYmplY3QgKF9fd2VicGFja19tb2R1bGVzX18pXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLm0gPSBtb2R1bGVzO1xuXG4gXHQvLyBleHBvc2UgdGhlIG1vZHVsZSBjYWNoZVxuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5jID0gaW5zdGFsbGVkTW9kdWxlcztcblxuIFx0Ly8gZGVmaW5lIGdldHRlciBmdW5jdGlvbiBmb3IgaGFybW9ueSBleHBvcnRzXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLmQgPSBmdW5jdGlvbihleHBvcnRzLCBuYW1lLCBnZXR0ZXIpIHtcbiBcdFx0aWYoIV9fd2VicGFja19yZXF1aXJlX18ubyhleHBvcnRzLCBuYW1lKSkge1xuIFx0XHRcdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBuYW1lLCB7IGVudW1lcmFibGU6IHRydWUsIGdldDogZ2V0dGVyIH0pO1xuIFx0XHR9XG4gXHR9O1xuXG4gXHQvLyBkZWZpbmUgX19lc01vZHVsZSBvbiBleHBvcnRzXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLnIgPSBmdW5jdGlvbihleHBvcnRzKSB7XG4gXHRcdGlmKHR5cGVvZiBTeW1ib2wgIT09ICd1bmRlZmluZWQnICYmIFN5bWJvbC50b1N0cmluZ1RhZykge1xuIFx0XHRcdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBTeW1ib2wudG9TdHJpbmdUYWcsIHsgdmFsdWU6ICdNb2R1bGUnIH0pO1xuIFx0XHR9XG4gXHRcdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAnX19lc01vZHVsZScsIHsgdmFsdWU6IHRydWUgfSk7XG4gXHR9O1xuXG4gXHQvLyBjcmVhdGUgYSBmYWtlIG5hbWVzcGFjZSBvYmplY3RcbiBcdC8vIG1vZGUgJiAxOiB2YWx1ZSBpcyBhIG1vZHVsZSBpZCwgcmVxdWlyZSBpdFxuIFx0Ly8gbW9kZSAmIDI6IG1lcmdlIGFsbCBwcm9wZXJ0aWVzIG9mIHZhbHVlIGludG8gdGhlIG5zXG4gXHQvLyBtb2RlICYgNDogcmV0dXJuIHZhbHVlIHdoZW4gYWxyZWFkeSBucyBvYmplY3RcbiBcdC8vIG1vZGUgJiA4fDE6IGJlaGF2ZSBsaWtlIHJlcXVpcmVcbiBcdF9fd2VicGFja19yZXF1aXJlX18udCA9IGZ1bmN0aW9uKHZhbHVlLCBtb2RlKSB7XG4gXHRcdGlmKG1vZGUgJiAxKSB2YWx1ZSA9IF9fd2VicGFja19yZXF1aXJlX18odmFsdWUpO1xuIFx0XHRpZihtb2RlICYgOCkgcmV0dXJuIHZhbHVlO1xuIFx0XHRpZigobW9kZSAmIDQpICYmIHR5cGVvZiB2YWx1ZSA9PT0gJ29iamVjdCcgJiYgdmFsdWUgJiYgdmFsdWUuX19lc01vZHVsZSkgcmV0dXJuIHZhbHVlO1xuIFx0XHR2YXIgbnMgPSBPYmplY3QuY3JlYXRlKG51bGwpO1xuIFx0XHRfX3dlYnBhY2tfcmVxdWlyZV9fLnIobnMpO1xuIFx0XHRPYmplY3QuZGVmaW5lUHJvcGVydHkobnMsICdkZWZhdWx0JywgeyBlbnVtZXJhYmxlOiB0cnVlLCB2YWx1ZTogdmFsdWUgfSk7XG4gXHRcdGlmKG1vZGUgJiAyICYmIHR5cGVvZiB2YWx1ZSAhPSAnc3RyaW5nJykgZm9yKHZhciBrZXkgaW4gdmFsdWUpIF9fd2VicGFja19yZXF1aXJlX18uZChucywga2V5LCBmdW5jdGlvbihrZXkpIHsgcmV0dXJuIHZhbHVlW2tleV07IH0uYmluZChudWxsLCBrZXkpKTtcbiBcdFx0cmV0dXJuIG5zO1xuIFx0fTtcblxuIFx0Ly8gZ2V0RGVmYXVsdEV4cG9ydCBmdW5jdGlvbiBmb3IgY29tcGF0aWJpbGl0eSB3aXRoIG5vbi1oYXJtb255IG1vZHVsZXNcbiBcdF9fd2VicGFja19yZXF1aXJlX18ubiA9IGZ1bmN0aW9uKG1vZHVsZSkge1xuIFx0XHR2YXIgZ2V0dGVyID0gbW9kdWxlICYmIG1vZHVsZS5fX2VzTW9kdWxlID9cbiBcdFx0XHRmdW5jdGlvbiBnZXREZWZhdWx0KCkgeyByZXR1cm4gbW9kdWxlWydkZWZhdWx0J107IH0gOlxuIFx0XHRcdGZ1bmN0aW9uIGdldE1vZHVsZUV4cG9ydHMoKSB7IHJldHVybiBtb2R1bGU7IH07XG4gXHRcdF9fd2VicGFja19yZXF1aXJlX18uZChnZXR0ZXIsICdhJywgZ2V0dGVyKTtcbiBcdFx0cmV0dXJuIGdldHRlcjtcbiBcdH07XG5cbiBcdC8vIE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbFxuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5vID0gZnVuY3Rpb24ob2JqZWN0LCBwcm9wZXJ0eSkgeyByZXR1cm4gT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKG9iamVjdCwgcHJvcGVydHkpOyB9O1xuXG4gXHQvLyBfX3dlYnBhY2tfcHVibGljX3BhdGhfX1xuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5wID0gXCJ3YWxsZXRcIjtcblxuIFx0dmFyIGpzb25wQXJyYXkgPSB3aW5kb3dbXCJ3ZWJwYWNrSnNvbnBcIl0gPSB3aW5kb3dbXCJ3ZWJwYWNrSnNvbnBcIl0gfHwgW107XG4gXHR2YXIgb2xkSnNvbnBGdW5jdGlvbiA9IGpzb25wQXJyYXkucHVzaC5iaW5kKGpzb25wQXJyYXkpO1xuIFx0anNvbnBBcnJheS5wdXNoID0gd2VicGFja0pzb25wQ2FsbGJhY2s7XG4gXHRqc29ucEFycmF5ID0ganNvbnBBcnJheS5zbGljZSgpO1xuIFx0Zm9yKHZhciBpID0gMDsgaSA8IGpzb25wQXJyYXkubGVuZ3RoOyBpKyspIHdlYnBhY2tKc29ucENhbGxiYWNrKGpzb25wQXJyYXlbaV0pO1xuIFx0dmFyIHBhcmVudEpzb25wRnVuY3Rpb24gPSBvbGRKc29ucEZ1bmN0aW9uO1xuXG5cbiBcdC8vIGFkZCBlbnRyeSBtb2R1bGUgdG8gZGVmZXJyZWQgbGlzdFxuIFx0ZGVmZXJyZWRNb2R1bGVzLnB1c2goWzYzLDEsNCwyLDMsNV0pO1xuIFx0Ly8gcnVuIGRlZmVycmVkIG1vZHVsZXMgd2hlbiByZWFkeVxuIFx0cmV0dXJuIGNoZWNrRGVmZXJyZWRNb2R1bGVzKCk7XG4iLCJtb2R1bGUuZXhwb3J0cyA9IGZldGNoOyIsIm1vZHVsZS5leHBvcnRzID0gUnVuOyIsIlwidXNlIHN0cmljdFwiO1xuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7IHZhbHVlOiB0cnVlIH0pO1xuY29uc3Qgd2FsbGV0X3NlcnZpY2VfMSA9IHJlcXVpcmUoXCIuL3NlcnZpY2VzL3dhbGxldC1zZXJ2aWNlXCIpO1xuLy8gaW1wb3J0IHsgY29uZmlnIH0gZnJvbSAnbm9kZS1jb25maWctdHMnO1xuZnVuY3Rpb24gaGlkZSgpIHtcbiAgICBBcnJheS5mcm9tKGRvY3VtZW50LmdldEVsZW1lbnRzQnlDbGFzc05hbWUoJ3BhbmVsJykpXG4gICAgICAgIC5mb3JFYWNoKChwKSA9PiBwLnN0eWxlLmRpc3BsYXkgPSAnbm9uZScpO1xufVxuZnVuY3Rpb24gc2hvdyhwYW5lbCkge1xuICAgIGhpZGUoKTtcbiAgICBjb25zdCBwYW5lbEVsZW1lbnQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChwYW5lbCk7XG4gICAgaWYgKHBhbmVsRWxlbWVudCkge1xuICAgICAgICBwYW5lbEVsZW1lbnQuc3R5bGUuZGlzcGxheSA9ICdibG9jayc7XG4gICAgfVxufVxuZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignRE9NQ29udGVudExvYWRlZCcsIGFzeW5jIChldmVudCkgPT4ge1xuICAgIHZhciBfYSwgX2I7XG4gICAgY29uc29sZS5sb2coJ0xPQURFRCcpO1xuICAgIGNvbnN0IHdhbGxldCA9IG5ldyB3YWxsZXRfc2VydmljZV8xLldhbGxldFNlcnZpY2UoKTtcbiAgICB3YWxsZXQub24oJ3Nob3cnLCAocGFuZWwpID0+IHtcbiAgICAgICAgY29uc29sZS5sb2coJ1NIT1c6JywgcGFuZWwpO1xuICAgICAgICBzaG93KHBhbmVsKTtcbiAgICB9KTtcbiAgICB3YWxsZXQub24oJ2hpZGUnLCAocGFuZWwpID0+IHtcbiAgICAgICAgaGlkZSgpO1xuICAgIH0pO1xuICAgIHRyeSB7XG4gICAgICAgIGF3YWl0IHdhbGxldC5pbml0KCk7XG4gICAgfVxuICAgIGNhdGNoIChlcnIpIHtcbiAgICAgICAgY29uc29sZS5sb2coZXJyKTtcbiAgICB9XG4gICAgKF9hID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2xvZ2luLWJ0bicpKSA9PT0gbnVsbCB8fCBfYSA9PT0gdm9pZCAwID8gdm9pZCAwIDogX2EuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoZSkgPT4ge1xuICAgICAgICB2YXIgX2EsIF9iO1xuICAgICAgICBjb25zdCBoYW5kbGUgPSAoX2EgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbC1oYW5kbGUnKSkgPT09IG51bGwgfHwgX2EgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9hLnZhbHVlO1xuICAgICAgICBjb25zdCBwYXNzd29yZCA9IChfYiA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdsLXBhc3N3b3JkJykpID09PSBudWxsIHx8IF9iID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfYi52YWx1ZTtcbiAgICAgICAgd2FsbGV0LmxvZ2luKGhhbmRsZSwgcGFzc3dvcmQpO1xuICAgIH0pO1xuICAgIChfYiA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdyZWdpc3Rlci1idG4nKSkgPT09IG51bGwgfHwgX2IgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9iLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKGUpID0+IHtcbiAgICAgICAgdmFyIF9hLCBfYiwgX2M7XG4gICAgICAgIGNvbnN0IGhhbmRsZSA9IChfYSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdyLWhhbmRsZScpKSA9PT0gbnVsbCB8fCBfYSA9PT0gdm9pZCAwID8gdm9pZCAwIDogX2EudmFsdWU7XG4gICAgICAgIGNvbnN0IGVtYWlsID0gKF9iID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3ItZW1haWwnKSkgPT09IG51bGwgfHwgX2IgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9iLnZhbHVlO1xuICAgICAgICBjb25zdCBwYXNzd29yZCA9IChfYyA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdyLXBhc3N3b3JkJykpID09PSBudWxsIHx8IF9jID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfYy52YWx1ZTtcbiAgICAgICAgd2FsbGV0LnJlZ2lzdGVyKGhhbmRsZSwgcGFzc3dvcmQsIGVtYWlsKTtcbiAgICB9KTtcbiAgICBjb25zdCBlbGVtZW50ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnaDEnKTtcbiAgICAvLyBlbGVtZW50LmlubmVySFRNTCA9IGAke2NvbmZpZy5jb25maWd9OiAke2NvbmZpZy5tb2RlfWA7XG4gICAgZG9jdW1lbnQuYm9keS5hcHBlbmRDaGlsZChlbGVtZW50KTtcbn0pO1xuIiwiXCJ1c2Ugc3RyaWN0XCI7XG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHsgdmFsdWU6IHRydWUgfSk7XG5leHBvcnRzLldhbGxldFNlcnZpY2UgPSB2b2lkIDA7XG5jb25zdCBic3ZfMSA9IHJlcXVpcmUoXCJic3ZcIik7XG5jb25zdCBub2RlX2NvbmZpZ190c18xID0gcmVxdWlyZShcIm5vZGUtY29uZmlnLXRzXCIpO1xuY29uc3QgcXVlcnlzdHJpbmcgPSByZXF1aXJlKFwicXVlcnlzdHJpbmdcIik7XG5jb25zdCB3YWxsZXRfMSA9IHJlcXVpcmUoXCJAa3Jvbm92ZXJzZS90b29scy9saWIvd2FsbGV0XCIpO1xuY29uc3QgcmVzdF9ibG9ja2NoYWluXzEgPSByZXF1aXJlKFwiQGtyb25vdmVyc2UvdG9vbHMvbGliL3Jlc3QtYmxvY2tjaGFpblwiKTtcbmNvbnN0IHJlc3Rfc3RhdGVfY2FjaGVfMSA9IHJlcXVpcmUoXCJAa3Jvbm92ZXJzZS90b29scy9saWIvc3RvcmFnZS9yZXN0LXN0YXRlLWNhY2hlXCIpO1xuY29uc3QgaW9yZWRpc19tb2NrXzEgPSByZXF1aXJlKFwiQGtyb25vdmVyc2UvdG9vbHMvbGliL2lvcmVkaXMtbW9ja1wiKTtcbmNvbnN0IHNpZ25lZF9tZXNzYWdlXzEgPSByZXF1aXJlKFwiQGtyb25vdmVyc2UvdG9vbHMvbGliL3NpZ25lZC1tZXNzYWdlXCIpO1xuY29uc3QgYXV0aF8xID0gcmVxdWlyZShcIkBrcm9ub3ZlcnNlL3Rvb2xzL2xpYi9hdXRoXCIpO1xuY29uc3QgZXZlbnRzXzEgPSByZXF1aXJlKFwiZXZlbnRzXCIpO1xuY29uc3Qgd3NfY2xpZW50XzEgPSByZXF1aXJlKFwiQGtyb25vdmVyc2UvdG9vbHMvbGliL3dzLWNsaWVudFwiKTtcbmNvbnN0IFJ1biA9IHJlcXVpcmUoJ0Brcm9ub3ZlcnNlL3J1bicpO1xubGV0IHF1ZXJ5UGFyYW1zID0ge307XG5jb25zdCB1cmxQYXJ0cyA9IHdpbmRvdy5sb2NhdGlvbi5ocmVmLnNwbGl0KCc/Jyk7XG5pZiAodXJsUGFydHNbMV0pIHtcbiAgICBjb25zdCBbcXVlcnldID0gdXJsUGFydHNbMV0uc3BsaXQoJyMnKTtcbiAgICBxdWVyeVBhcmFtcyA9IHF1ZXJ5c3RyaW5nLmRlY29kZShxdWVyeSk7XG59XG5ic3ZfMS5Db25zdGFudHMuRGVmYXVsdCA9IG5vZGVfY29uZmlnX3RzXzEuY29uZmlnLm5ldHdvcmsgPT09ICdtYWluJyA/IGJzdl8xLkNvbnN0YW50cy5NYWlubmV0IDogYnN2XzEuQ29uc3RhbnRzLlRlc3RuZXQ7XG5jb25zdCBic3YgPSByZXF1aXJlKCdic3YnKTtcbmJzdi5Db25zdGFudHMuRGVmYXVsdCA9IGJzdl8xLkNvbnN0YW50cy5EZWZhdWx0O1xuY29uc29sZS5sb2coJ0xPQUQnKTtcbmNsYXNzIFdhbGxldFNlcnZpY2UgZXh0ZW5kcyBldmVudHNfMS5FdmVudEVtaXR0ZXIge1xuICAgIGNvbnN0cnVjdG9yKCkge1xuICAgICAgICBzdXBlcigpO1xuICAgICAgICB0aGlzLnByaW50TG9nID0gY29uc29sZS5sb2cuYmluZChjb25zb2xlKTtcbiAgICAgICAgdGhpcy5wcmludEVycm9yID0gY29uc29sZS5lcnJvci5iaW5kKGNvbnNvbGUpO1xuICAgICAgICAvLyBwcml2YXRlIHJlcXVlc3RTZXJ2aWNlOiBSZXF1ZXN0U2VydmljZTtcbiAgICAgICAgdGhpcy5sb2dJZCA9IDA7XG4gICAgICAgIHRoaXMubG9ncyA9IFtdO1xuICAgICAgICB0aGlzLnNlc3Npb25JZCA9IGAke0RhdGUubm93KCl9LSR7TWF0aC5yYW5kb20oKSAqIE51bWJlci5NQVhfU0FGRV9JTlRFR0VSfWA7XG4gICAgICAgIHRoaXMudGltZUxhYmVscyA9IHt9O1xuICAgICAgICB0aGlzLmFwaVVybCA9IHF1ZXJ5UGFyYW1zLmFwaVVybCB8fCBub2RlX2NvbmZpZ190c18xLmNvbmZpZy5hcGlVcmw7XG4gICAgICAgIHRoaXMuZG9tYWluID0gZG9jdW1lbnQubG9jYXRpb24uaGFzaC5zbGljZSgxKS5zcGxpdCgnQCcpWzFdO1xuICAgICAgICB0aGlzLm92ZXJyaWRlQ29uc29sZSgpO1xuICAgICAgICB0aGlzLmF1dGggPSBuZXcgYXV0aF8xLktyb25vQXV0aCh0aGlzLmFwaVVybCwgdGhpcy5kb21haW4sIG5vZGVfY29uZmlnX3RzXzEuY29uZmlnLm5ldHdvcmspO1xuICAgIH1cbiAgICBnZXQgY2hhbm5lbCgpIHtcbiAgICAgICAgY29uc3QgdiA9IHdpbmRvdy52dXBsZXg7XG4gICAgICAgIHJldHVybiAodikgPyB2IDogd2luZG93O1xuICAgIH1cbiAgICBnZXQgY2hhbm5lbFNjb3BlKCkge1xuICAgICAgICBjb25zdCByZWYgPSBkb2N1bWVudC5yZWZlcnJlcjtcbiAgICAgICAgaWYgKHJlZiAmJiAhdGhpcy5pc0luVW5pdHkpIHtcbiAgICAgICAgICAgIHJldHVybiByZWYubWF0Y2goL14uKzpcXC9cXC9bXlxcL10rLylbMF07XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgICAgfVxuICAgIH1cbiAgICBnZXQgaXNJblVuaXR5KCkge1xuICAgICAgICByZXR1cm4gKHdpbmRvdy52dXBsZXgpID8gdHJ1ZSA6IGZhbHNlO1xuICAgIH1cbiAgICBnZXQgaGFuZGxlKCkge1xuICAgICAgICByZXR1cm4gd2luZG93LmxvY2FsU3RvcmFnZS5nZXRJdGVtKCdIQU5ETEUnKSB8fCAnJztcbiAgICB9XG4gICAgc2V0IGhhbmRsZSh2YWx1ZSkge1xuICAgICAgICB3aW5kb3cubG9jYWxTdG9yYWdlLnNldEl0ZW0oJ0hBTkRMRScsIHZhbHVlKTtcbiAgICB9XG4gICAgZ2V0IGtleVBhaXIoKSB7XG4gICAgICAgIGNvbnN0IHdpZiA9IHdpbmRvdy5sb2NhbFN0b3JhZ2UuZ2V0SXRlbSgnV0lGJyk7XG4gICAgICAgIGlmICghd2lmKVxuICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgIHJldHVybiBic3ZfMS5LZXlQYWlyLmZyb21Qcml2S2V5KGJzdl8xLlByaXZLZXkuZnJvbVN0cmluZyh3aWYpKTtcbiAgICB9XG4gICAgc2V0IGtleVBhaXIoa2V5UGFpcikge1xuICAgICAgICB3aW5kb3cubG9jYWxTdG9yYWdlLnNldEl0ZW0oJ1dJRicsIGtleVBhaXIucHJpdktleS50b1N0cmluZygpKTtcbiAgICB9XG4gICAgZ2V0IGFnZW50SWQoKSB7XG4gICAgICAgIHJldHVybiBkb2N1bWVudC5sb2NhdGlvbi5oYXNoLnNsaWNlKDEpLnNwbGl0KCdAJylbMF07XG4gICAgfVxuICAgIGdldCBwYXltYWlsKCkge1xuICAgICAgICByZXR1cm4gYCR7dGhpcy5oYW5kbGV9QCR7dGhpcy5kb21haW59YDtcbiAgICB9XG4gICAgYXN5bmMgaW5pdCgpIHtcbiAgICAgICAgY29uc29sZS5sb2coJ0lOSVQnKTtcbiAgICAgICAgbGV0IGluaXRpYWxpemVkID0gZmFsc2U7XG4gICAgICAgIHdoaWxlIChub2RlX2NvbmZpZ190c18xLmNvbmZpZy5lcGhlbWVyYWwgJiYgIWluaXRpYWxpemVkKSB7XG4gICAgICAgICAgICBhd2FpdCBuZXcgUHJvbWlzZSgocmVzb2x2ZSkgPT4gc2V0VGltZW91dCgoKSA9PiByZXNvbHZlKCksIDUwMDApKTtcbiAgICAgICAgICAgIGNvbnN0IHJlc3AgPSBhd2FpdCBmZXRjaChgJHt0aGlzLmFwaVVybH0vaW5pdGlhbGl6ZWApO1xuICAgICAgICAgICAgaW5pdGlhbGl6ZWQgPSByZXNwLm9rICYmIGF3YWl0IHJlc3AuanNvbigpO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuY2xpZW50RW1pdCgnV0FMTEVUX1JFQURZJyk7XG4gICAgICAgIHRoaXMuY2hhbm5lbC5hZGRFdmVudExpc3RlbmVyKCdtZXNzYWdlJywgdGhpcy5vbkNsaWVudEV2ZW50LmJpbmQodGhpcykpO1xuICAgICAgICBjb25zb2xlLmxvZygnQkxPQ0tDSEFJTjonLCB0aGlzLmFwaVVybCk7XG4gICAgICAgIGNvbnN0IHVybCA9IGAke3RoaXMuYXBpVXJsfS9hZ2VudHMvJHt0aGlzLmRvbWFpbn0vJHt0aGlzLmFnZW50SWR9YDtcbiAgICAgICAgY29uc29sZS5sb2coJ2ZldGNoaW5nOicsIHVybCk7XG4gICAgICAgIGNvbnN0IHJlc3AgPSBhd2FpdCBmZXRjaCh1cmwpO1xuICAgICAgICBpZiAoIXJlc3Aub2spXG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYCR7cmVzcC5zdGF0dXN9IC0gJHtyZXNwLnN0YXR1c1RleHR9YCk7XG4gICAgICAgIHRoaXMuYWdlbnREZWYgPSBhd2FpdCByZXNwLmpzb24oKTtcbiAgICAgICAgaWYgKCF0aGlzLmFnZW50RGVmKVxuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdBR0VOVCBNSVNTSU5HJyk7XG4gICAgICAgIGlmIChub2RlX2NvbmZpZ190c18xLmNvbmZpZy5lcnJvckxvZykge1xuICAgICAgICAgICAgc2V0SW50ZXJ2YWwoYXN5bmMgKCkgPT4ge1xuICAgICAgICAgICAgICAgIGNvbnN0IGxvZ3MgPSB0aGlzLmxvZ3M7XG4gICAgICAgICAgICAgICAgdGhpcy5sb2dzID0gW107XG4gICAgICAgICAgICAgICAgaWYgKCFsb2dzLmxlbmd0aClcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgIGNvbnN0IHJlc3AgPSBhd2FpdCBmZXRjaChub2RlX2NvbmZpZ190c18xLmNvbmZpZy5lcnJvckxvZywge1xuICAgICAgICAgICAgICAgICAgICBtZXRob2Q6ICdQT1NUJyxcbiAgICAgICAgICAgICAgICAgICAgaGVhZGVyczogeyAnQ29udGVudC1UeXBlJzogJ2FwcGxpY2F0aW9uL2pzb24nIH0sXG4gICAgICAgICAgICAgICAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KGxvZ3MpXG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgaWYgKCFyZXNwLm9rKVxuICAgICAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYCR7cmVzcC5zdGF0dXN9IC0gJHtyZXNwLnN0YXR1c1RleHR9YCk7XG4gICAgICAgICAgICB9LCA1MDAwKTtcbiAgICAgICAgfVxuICAgICAgICAvLyB0aGlzLmVtaXQoJ3Nob3cnLCAnbG9naW4nKTtcbiAgICAgICAgLy8gY29uc29sZS5sb2coJ1NIT1cgTE9HSU4nKTtcbiAgICAgICAgaWYgKHRoaXMuYWdlbnREZWYuYW5vbnltb3VzKVxuICAgICAgICAgICAgcmV0dXJuIHRoaXMuaW5pdGlhbGl6ZVdhbGxldCgpO1xuICAgICAgICBpZiAoIW5vZGVfY29uZmlnX3RzXzEuY29uZmlnLmVwaGVtZXJhbCAmJiAhdGhpcy5rZXlQYWlyKVxuICAgICAgICAgICAgcmV0dXJuIHRoaXMuY2xpZW50RW1pdCgnTk9fS0VZUycpO1xuICAgICAgICB0cnkge1xuICAgICAgICAgICAgYXdhaXQgdGhpcy5pbml0aWFsaXplVXNlcigpO1xuICAgICAgICB9XG4gICAgICAgIGNhdGNoIChlKSB7XG4gICAgICAgICAgICBjb25zb2xlLmVycm9yKCdMb2dpbiBFcnJvcjonLCBlLm1lc3NhZ2UpO1xuICAgICAgICAgICAgdGhpcy5jbGllbnRFbWl0KCdOT19LRVlTJyk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgYXN5bmMgaW5pdGlhbGl6ZVdhbGxldChvd25lciwgcHVyc2UpIHtcbiAgICAgICAgY29uc3QgY2FjaGUgPSBuZXcgUnVuLkxvY2FsQ2FjaGUoeyBtYXhTaXplTUI6IDEwMCB9KTtcbiAgICAgICAgY29uc3QgYmxvY2tjaGFpbiA9IG5ldyByZXN0X2Jsb2NrY2hhaW5fMS5SZXN0QmxvY2tjaGFpbih0aGlzLmFwaVVybCwgbm9kZV9jb25maWdfdHNfMS5jb25maWcubmV0d29yaywgY2FjaGUpO1xuICAgICAgICBjb25zdCBydW4gPSBuZXcgUnVuKHtcbiAgICAgICAgICAgIG5ldHdvcms6IG5vZGVfY29uZmlnX3RzXzEuY29uZmlnLm5ldHdvcmssXG4gICAgICAgICAgICBvd25lcixcbiAgICAgICAgICAgIGJsb2NrY2hhaW4sXG4gICAgICAgICAgICBwdXJzZSxcbiAgICAgICAgICAgIGNhY2hlOiBuZXcgcmVzdF9zdGF0ZV9jYWNoZV8xLlJlc3RTdGF0ZUNhY2hlKHRoaXMuYXBpVXJsLCBjYWNoZSksXG4gICAgICAgICAgICBhcHA6IG5vZGVfY29uZmlnX3RzXzEuY29uZmlnLmFwcCB8fCAna3Jvbm92ZXJzZScsXG4gICAgICAgICAgICB0cnVzdDogJyonLFxuICAgICAgICAgICAgdGltZW91dDogNjAwMDAsXG4gICAgICAgICAgICBsb2dnZXI6IHtcbiAgICAgICAgICAgICAgICBlcnJvcjogY29uc29sZS5lcnJvclxuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICAgICAgY29uc3Qgd2FsbGV0ID0gdGhpcy53YWxsZXQgPSBuZXcgd2FsbGV0XzEuV2FsbGV0KHRoaXMucGF5bWFpbCwgdGhpcy5rZXlQYWlyLCBydW4pO1xuICAgICAgICBjb25zdCBzdG9yYWdlID0gbmV3IGlvcmVkaXNfbW9ja18xLklPUmVkaXNNb2NrKCk7XG4gICAgICAgIGNvbnN0IGNoYW5uZWxzID0gW3RoaXMua2V5UGFpci5wdWJLZXkudG9TdHJpbmcoKV07XG4gICAgICAgIGxldCB3cztcbiAgICAgICAgaWYgKG5vZGVfY29uZmlnX3RzXzEuY29uZmlnLnNvY2tldHMpIHtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKCdTb2NrZXRzOicsIG5vZGVfY29uZmlnX3RzXzEuY29uZmlnLnNvY2tldHMpO1xuICAgICAgICAgICAgd3MgPSBuZXcgd3NfY2xpZW50XzEuV1NDbGllbnQoV2ViU29ja2V0LCBub2RlX2NvbmZpZ190c18xLmNvbmZpZy5zb2NrZXRzLCBjaGFubmVscyk7XG4gICAgICAgIH1cbiAgICAgICAgY29uc29sZS5sb2coJ0RPTUFJTjonLCB0aGlzLmRvbWFpbik7XG4gICAgICAgIGNvbnNvbGUubG9nKCdBR0VOVF9JRDonLCB0aGlzLmFnZW50SWQpO1xuICAgICAgICBjb25zb2xlLmxvZygnTE9DOicsIHRoaXMuYWdlbnREZWYubG9jYXRpb24pO1xuICAgICAgICBjb25zdCBBZ2VudCA9IGF3YWl0IHJ1bi5sb2FkKHRoaXMuYWdlbnREZWYubG9jYXRpb24pO1xuICAgICAgICBjb25zdCBhZ2VudCA9IHRoaXMuYWdlbnQgPSBuZXcgQWdlbnQod2FsbGV0LCBibG9ja2NoYWluLCBzdG9yYWdlLCBic3YsIHsgZmV0Y2gsIEJ1ZmZlciwgd3MsIFNpZ25lZE1lc3NhZ2U6IHNpZ25lZF9tZXNzYWdlXzEuU2lnbmVkTWVzc2FnZSB9KTtcbiAgICAgICAgYWdlbnQub24oJ2NsaWVudCcsIHRoaXMuY2xpZW50RW1pdC5iaW5kKHRoaXMpKTtcbiAgICAgICAgYWdlbnQub24oJ3N1YnNjcmliZScsIChjaGFubmVsLCBsYXN0SWQpID0+IHtcbiAgICAgICAgICAgIHdzLnN1YnNjcmliZShjaGFubmVsLCBsYXN0SWQpO1xuICAgICAgICB9KTtcbiAgICAgICAgYWdlbnQub24oJ3Vuc3Vic2NyaWJlJywgKGNoYW5uZWwpID0+IHtcbiAgICAgICAgICAgIHdzLnVuc3Vic2NyaWJlKGNoYW5uZWwpO1xuICAgICAgICB9KTtcbiAgICAgICAgYXdhaXQgYWdlbnQuaW5pdCgpO1xuICAgICAgICB0aGlzLmNsaWVudEVtaXQoJ0FHRU5UX0xPQURFRCcpO1xuICAgICAgICB3cy5vbignamlnJywgKGppZywgY2hhbm5lbCkgPT4ge1xuICAgICAgICAgICAgY29uc29sZS5sb2coJ0pJRzonLCBKU09OLnN0cmluZ2lmeShqaWcpKTtcbiAgICAgICAgICAgIGFnZW50Lm9uSmlnKGppZykuY2F0Y2goY29uc29sZS5lcnJvcik7XG4gICAgICAgIH0pO1xuICAgICAgICB3cy5vbignbXNnJywgKG1lc3NhZ2UsIGNoYW5uZWwpID0+IHtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKCdNU0c6JywgSlNPTi5zdHJpbmdpZnkobWVzc2FnZSkpO1xuICAgICAgICAgICAgYWdlbnQub25NZXNzYWdlKG5ldyBzaWduZWRfbWVzc2FnZV8xLlNpZ25lZE1lc3NhZ2UobWVzc2FnZSkpLmNhdGNoKGNvbnNvbGUuZXJyb3IpO1xuICAgICAgICB9KTtcbiAgICB9XG4gICAgYXN5bmMgaW5pdGlhbGl6ZVVzZXIoaGFuZGxlKSB7XG4gICAgICAgIGNvbnNvbGUubG9nKCdJbml0aWFsaXppbmcgVXNlcicpO1xuICAgICAgICBpZiAoaGFuZGxlKVxuICAgICAgICAgICAgdGhpcy5oYW5kbGUgPSBoYW5kbGU7XG4gICAgICAgIGxldCBiaXAzMjtcbiAgICAgICAgaWYgKG5vZGVfY29uZmlnX3RzXzEuY29uZmlnLmVwaGVtZXJhbCkge1xuICAgICAgICAgICAgYmlwMzIgPSBic3ZfMS5CaXAzMi5mcm9tUmFuZG9tKCk7XG4gICAgICAgICAgICB0aGlzLmtleVBhaXIgPSBic3ZfMS5LZXlQYWlyLmZyb21Qcml2S2V5KGJpcDMyLnByaXZLZXkpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgY29uc29sZS5sb2coJ1JlY292ZXJpbmcgYWNjb3VudCcpO1xuICAgICAgICAgICAgY29uc3QgeHByaXYgPSBhd2FpdCB0aGlzLmF1dGgucmVjb3Zlcih0aGlzLnBheW1haWwsIHRoaXMua2V5UGFpcik7XG4gICAgICAgICAgICBiaXAzMiA9IGJzdl8xLkJpcDMyLmZyb21TdHJpbmcoeHByaXYpO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuaW5pdGlhbGl6ZVdhbGxldChiaXAzMi5kZXJpdmUoJ20vMS8wJykucHJpdktleS50b1N0cmluZygpLCBiaXAzMi5kZXJpdmUoJ20vMC8wJykucHJpdktleS50b1N0cmluZygpKTtcbiAgICB9XG4gICAgYXN5bmMgbG9naW4oaGFuZGxlLCBwYXNzd29yZCkge1xuICAgICAgICB0aGlzLmtleVBhaXIgPSBhd2FpdCB0aGlzLmF1dGgubG9naW4oaGFuZGxlLCBwYXNzd29yZCk7XG4gICAgICAgIGF3YWl0IHRoaXMuaW5pdGlhbGl6ZVVzZXIoaGFuZGxlKTtcbiAgICB9XG4gICAgYXN5bmMgcmVnaXN0ZXIoaGFuZGxlLCBwYXNzd29yZCwgZW1haWwpIHtcbiAgICAgICAgdGhpcy5rZXlQYWlyID0gYXdhaXQgdGhpcy5hdXRoLnJlZ2lzdGVyKGhhbmRsZSwgcGFzc3dvcmQsIGVtYWlsKTtcbiAgICAgICAgYXdhaXQgdGhpcy5pbml0aWFsaXplVXNlcihoYW5kbGUpO1xuICAgIH1cbiAgICBhc3luYyBsb2dvdXQoKSB7XG4gICAgICAgIHdpbmRvdy5sb2NhbFN0b3JhZ2UucmVtb3ZlSXRlbSgnV0lGJyk7XG4gICAgICAgIHdpbmRvdy5sb2NhbFN0b3JhZ2UucmVtb3ZlSXRlbSgnSEFORExFJyk7XG4gICAgfVxuICAgIGFzeW5jIG9uQ2xpZW50RXZlbnQoZXZlbnQpIHtcbiAgICAgICAgdmFyIF9hO1xuICAgICAgICBjb25zdCBtZXNzYWdlID0ge307XG4gICAgICAgIGlmICghdGhpcy50cnlQYXJzZU1lc3NhZ2VEYXRhKGV2ZW50LmRhdGEsIG1lc3NhZ2UpKVxuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICBpZiAoWydSZWdpc3RlcicsICdMb2dpbiddLmluY2x1ZGVzKG1lc3NhZ2UubmFtZSkpIHtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKGBXQUxMRVQgUkVDRUlWRUQgRVZFTlQ6YCwgbWVzc2FnZS5uYW1lKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKGBXQUxMRVQgUkVDRUlWRUQgRVZFTlQ6YCwgSlNPTi5zdHJpbmdpZnkobWVzc2FnZSkpO1xuICAgICAgICB9XG4gICAgICAgIGNvbnN0IHJlc3BvbnNlID0ge1xuICAgICAgICAgICAgbmFtZTogYE9uJHttZXNzYWdlLm5hbWV9YFxuICAgICAgICB9O1xuICAgICAgICB0cnkge1xuICAgICAgICAgICAgY29uc3QgcGF5bG9hZCA9IG1lc3NhZ2UucGF5bG9hZCAmJiBKU09OLnBhcnNlKG1lc3NhZ2UucGF5bG9hZCk7XG4gICAgICAgICAgICBzd2l0Y2ggKG1lc3NhZ2UubmFtZSkge1xuICAgICAgICAgICAgICAgIGNhc2UgJ1JlZ2lzdGVyJzpcbiAgICAgICAgICAgICAgICAgICAgYXdhaXQgdGhpcy5yZWdpc3RlcihwYXlsb2FkLmhhbmRsZSwgcGF5bG9hZC5wYXNzd29yZCwgcGF5bG9hZC5lbWFpbCk7XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIGNhc2UgJ0xvZ2luJzpcbiAgICAgICAgICAgICAgICAgICAgYXdhaXQgdGhpcy5sb2dpbihwYXlsb2FkLmhhbmRsZSwgcGF5bG9hZC5wYXNzd29yZCk7XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIGNhc2UgJ0xvZ291dCc6XG4gICAgICAgICAgICAgICAgICAgIGF3YWl0IHRoaXMubG9nb3V0KCk7XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIGNhc2UgJ0Nhc2hvdXQnOlxuICAgICAgICAgICAgICAgICAgICBpZiAoIXRoaXMud2FsbGV0KVxuICAgICAgICAgICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdXYWxsZXQgbm90IGluaXRpYWxpemVkJyk7XG4gICAgICAgICAgICAgICAgICAgIC8vIGF3YWl0IHRoaXMud2FsbGV0LmNhc2hvdXQocGF5bG9hZCk7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuY2xpZW50RW1pdCgnQmFsYW5jZVVwZGF0ZWQnLCAwKTtcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgY2FzZSAnSXNIYW5kbGVBdmFpbGFibGUnOlxuICAgICAgICAgICAgICAgICAgICByZXNwb25zZS5wYXlsb2FkID0gSlNPTi5zdHJpbmdpZnkoYXdhaXQgdGhpcy5hdXRoLmlzSGFuZGxlQXZhaWxhYmxlKHBheWxvYWQpKTtcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICAgICAgaWYgKCF0aGlzLmFnZW50KVxuICAgICAgICAgICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdBZ2VudCBub3QgaW5pdGlhbGl6ZWQnKTtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgKChfYSA9IHRoaXMuYWdlbnQpID09PSBudWxsIHx8IF9hID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfYS5vbkV2ZW50KG1lc3NhZ2UubmFtZSwgcGF5bG9hZCkpO1xuICAgICAgICAgICAgICAgICAgICByZXNwb25zZS5wYXlsb2FkID0gcmVzdWx0ICYmIEpTT04uc3RyaW5naWZ5KHJlc3VsdCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXNwb25zZS5zdWNjZXNzID0gdHJ1ZTtcbiAgICAgICAgfVxuICAgICAgICBjYXRjaCAoZSkge1xuICAgICAgICAgICAgcmVzcG9uc2Uuc3VjY2VzcyA9IGZhbHNlO1xuICAgICAgICAgICAgcmVzcG9uc2UucGF5bG9hZCA9IEpTT04uc3RyaW5naWZ5KGUubWVzc2FnZSk7XG4gICAgICAgICAgICBpZiAoZS5tZXNzYWdlLmluY2x1ZGVzKCdOb3QgZW5vdWdoIGZ1bmRzJykpIHtcbiAgICAgICAgICAgICAgICByZXNwb25zZS5zdGF0dXNDb2RlID0gNDAyO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgcmVzcG9uc2Uuc3RhdHVzQ29kZSA9IGUuc3RhdHVzIHx8IDUwMDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBjb25zb2xlLmxvZyhyZXNwb25zZS5uYW1lLCByZXNwb25zZS5wYXlsb2FkKTtcbiAgICAgICAgdGhpcy5wb3N0TWVzc2FnZShyZXNwb25zZSk7XG4gICAgICAgIHJldHVybjtcbiAgICB9XG4gICAgdHJ5UGFyc2VNZXNzYWdlRGF0YShkYXRhLCBvdXRCeVJlZikge1xuICAgICAgICBjb25zdCBtZXNzYWdlID0gKG91dEJ5UmVmIHx8IHt9KTtcbiAgICAgICAgaWYgKHR5cGVvZiBkYXRhID09PSAnc3RyaW5nJykge1xuICAgICAgICAgICAgT2JqZWN0LmFzc2lnbihtZXNzYWdlLCBKU09OLnBhcnNlKEJ1ZmZlci5mcm9tKGRhdGEsICdiYXNlNjQnKS50b1N0cmluZygpKSk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAodHlwZW9mIGRhdGEgPT09ICdvYmplY3QnKSB7XG4gICAgICAgICAgICBPYmplY3QuYXNzaWduKG1lc3NhZ2UsIGRhdGEpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBtZXNzYWdlICYmIG1lc3NhZ2UubmFtZTtcbiAgICB9XG4gICAgY2xpZW50RW1pdChuYW1lLCBwYXlsb2FkKSB7XG4gICAgICAgIC8vIGNvbnNvbGUubG9nKCdFbWl0dGluZycsIG5hbWUsIHBheWxvYWQgJiYgSlNPTi5zdHJpbmdpZnkocGF5bG9hZCkpO1xuICAgICAgICBjb25zdCBtZXNzYWdlID0ge1xuICAgICAgICAgICAgbmFtZSxcbiAgICAgICAgICAgIHBheWxvYWQ6IHBheWxvYWQgJiYgSlNPTi5zdHJpbmdpZnkocGF5bG9hZCksXG4gICAgICAgICAgICBzdWNjZXNzOiB0cnVlXG4gICAgICAgIH07XG4gICAgICAgIHRoaXMubG9ncy5wdXNoKHtcbiAgICAgICAgICAgIGlkeDogdGhpcy5sb2dJZCsrLFxuICAgICAgICAgICAgc2Vzc2lvbklkOiB0aGlzLnNlc3Npb25JZCxcbiAgICAgICAgICAgIGhhbmRsZTogdGhpcy5oYW5kbGUsXG4gICAgICAgICAgICB0eXBlOiAnbG9nJyxcbiAgICAgICAgICAgIHRzOiBEYXRlLm5vdygpLFxuICAgICAgICAgICAgbWVzc2FnZToge1xuICAgICAgICAgICAgICAgIG5hbWUsXG4gICAgICAgICAgICAgICAgcGF5bG9hZFxuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICAgICAgdGhpcy5wb3N0TWVzc2FnZShtZXNzYWdlKTtcbiAgICB9XG4gICAgcG9zdE1lc3NhZ2UobWVzc2FnZSkge1xuICAgICAgICBtZXNzYWdlLnRhcmdldCA9ICdrcm9ub3ZlcnNlJztcbiAgICAgICAgaWYgKHRoaXMuaXNJblVuaXR5KSB7XG4gICAgICAgICAgICB0aGlzLmNoYW5uZWwucG9zdE1lc3NhZ2UobWVzc2FnZSk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAodGhpcy5jaGFubmVsU2NvcGUpIHtcbiAgICAgICAgICAgIHRoaXMuY2hhbm5lbC5wYXJlbnQucG9zdE1lc3NhZ2UobWVzc2FnZSwgdGhpcy5jaGFubmVsU2NvcGUpO1xuICAgICAgICB9XG4gICAgfVxuICAgIG92ZXJyaWRlQ29uc29sZSgpIHtcbiAgICAgICAgY29uc29sZS5sb2cgPSAoLi4ubWVzc2FnZXMpID0+IHtcbiAgICAgICAgICAgIG1lc3NhZ2VzLnVuc2hpZnQoRGF0ZS5ub3coKSk7XG4gICAgICAgICAgICBjb25zdCBtZXNzYWdlID0gbWVzc2FnZXMuam9pbignICcpO1xuICAgICAgICAgICAgdGhpcy5sb2dzLnB1c2goe1xuICAgICAgICAgICAgICAgIGlkeDogdGhpcy5sb2dJZCsrLFxuICAgICAgICAgICAgICAgIHNlc3Npb25JZDogdGhpcy5zZXNzaW9uSWQsXG4gICAgICAgICAgICAgICAgcGF5bWFpbDogdGhpcy5wYXltYWlsLFxuICAgICAgICAgICAgICAgIHR5cGU6ICdsb2cnLFxuICAgICAgICAgICAgICAgIHRzOiBEYXRlLm5vdygpLFxuICAgICAgICAgICAgICAgIG1lc3NhZ2VcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgaWYgKG5vZGVfY29uZmlnX3RzXzEuY29uZmlnLmVtaXRMb2dzKVxuICAgICAgICAgICAgICAgIHRoaXMuY2xpZW50RW1pdCgnTG9nJywgbWVzc2FnZSk7XG4gICAgICAgICAgICB0aGlzLnByaW50TG9nKC4uLm1lc3NhZ2VzKTtcbiAgICAgICAgfTtcbiAgICAgICAgY29uc29sZS5lcnJvciA9ICguLi5tZXNzYWdlcykgPT4ge1xuICAgICAgICAgICAgbWVzc2FnZXMudW5zaGlmdChEYXRlLm5vdygpKTtcbiAgICAgICAgICAgIGNvbnN0IG1lc3NhZ2UgPSBtZXNzYWdlcy5qb2luKCcgJyk7XG4gICAgICAgICAgICB0aGlzLmxvZ3MucHVzaCh7XG4gICAgICAgICAgICAgICAgaWR4OiB0aGlzLmxvZ0lkKyssXG4gICAgICAgICAgICAgICAgc2Vzc2lvbklkOiB0aGlzLnNlc3Npb25JZCxcbiAgICAgICAgICAgICAgICBwYXltYWlsOiB0aGlzLnBheW1haWwsXG4gICAgICAgICAgICAgICAgdHlwZTogJ2Vycm9yJyxcbiAgICAgICAgICAgICAgICB0czogRGF0ZS5ub3coKSxcbiAgICAgICAgICAgICAgICBtZXNzYWdlXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIGlmIChub2RlX2NvbmZpZ190c18xLmNvbmZpZy5lbWl0TG9ncylcbiAgICAgICAgICAgICAgICB0aGlzLmNsaWVudEVtaXQoJ0Vycm9yJywgbWVzc2FnZSk7XG4gICAgICAgICAgICB0aGlzLnByaW50RXJyb3IoLi4ubWVzc2FnZXMpO1xuICAgICAgICB9O1xuICAgICAgICBjb25zb2xlLnRpbWUgPSAobGFiZWwpID0+IHtcbiAgICAgICAgICAgIHRoaXMudGltZUxhYmVsc1tsYWJlbF0gPSBEYXRlLm5vdygpO1xuICAgICAgICB9O1xuICAgICAgICBjb25zb2xlLnRpbWVFbmQgPSAobGFiZWwpID0+IHtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKGAke2xhYmVsfTogJHtEYXRlLm5vdygpIC0gdGhpcy50aW1lTGFiZWxzW2xhYmVsXSB8fCAwfW1zYCk7XG4gICAgICAgIH07XG4gICAgfVxufVxuZXhwb3J0cy5XYWxsZXRTZXJ2aWNlID0gV2FsbGV0U2VydmljZTtcbiJdLCJzb3VyY2VSb290IjoiIn0=